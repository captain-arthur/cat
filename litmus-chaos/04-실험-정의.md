# 실험(Experiment) 정의

LitmusChaos에서 Chaos Experiment를 정의하는 방법을 상세히 설명합니다.

## ChaosExperiment 및 ChaosEngine 구조

LitmusChaos는 `ChaosExperiment`(템플릿)와 `ChaosEngine`(실행)으로 실험을 정의합니다.

### ChaosExperiment (템플릿)

실험 템플릿을 정의하는 CRD입니다.

### ChaosEngine (실행)

실제 실험을 실행하는 CRD입니다.

```yaml
apiVersion: litmuschaos.io/v1alpha1
kind: ChaosEngine
metadata:
  name: <experiment-name>
  namespace: <namespace>
spec:
  appinfo:
    appns: <namespace>
    applabel: <label-selector>
    appkind: <kind>
  engineState: 'active'
  chaosServiceAccount: litmus-admin
  experiments:
    - name: <experiment-name>
      spec:
        components:
          env:
            - name: <parameter-name>
              value: <parameter-value>
  probes:
    - name: <probe-name>
      type: <probe-type>
      # Probe 설정
```

## 주요 실험 유형

### 1. Pod Delete

```yaml
apiVersion: litmuschaos.io/v1alpha1
kind: ChaosEngine
metadata:
  name: pod-delete-example
  namespace: default
spec:
  appinfo:
    appns: default
    applabel: app=test-app
    appkind: deployment
  engineState: 'active'
  chaosServiceAccount: litmus-admin
  experiments:
    - name: pod-delete
      spec:
        components:
          env:
            - name: TOTAL_CHAOS_DURATION
              value: '30'
            - name: CHAOS_INTERVAL
              value: '10'
```

### 2. Network Chaos

```yaml
apiVersion: litmuschaos.io/v1alpha1
kind: ChaosEngine
metadata:
  name: network-chaos-example
  namespace: default
spec:
  appinfo:
    appns: default
    applabel: app=test-app
    appkind: deployment
  engineState: 'active'
  chaosServiceAccount: litmus-admin
  experiments:
    - name: network-chaos
      spec:
        components:
          env:
            - name: NETWORK_CHAOS_TYPE
              value: 'network-partition'
```

## Probes 설정

### HTTP Probe

```yaml
probes:
  - name: http-probe
    type: httpProbe
    httpProbe/inputs:
      url: https://example.com/health
      insecureSkipVerify: false
    mode: Continuous
    runProperties:
      probeTimeout: 5
      interval: 2
      retry: 1
```

### Prometheus Probe

```yaml
probes:
  - name: prometheus-probe
    type: promProbe
    promProbe/inputs:
      endpoint: http://prometheus:9090/api/v1/query
      query: up{job="test-app"}
    mode: Continuous
```

## 관련 문서

- [03-설치및사용법.md](./03-설치및사용법.md) - 설치부터 실행까지 기본 워크플로우
- [05-워크플로우.md](./05-워크플로우.md) - Workflow 사용 방법
- [06-CAT-활용.md](./06-CAT-활용.md) - CAT 관점에서의 활용
