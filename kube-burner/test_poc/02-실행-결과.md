# kube-burner POC 실행 결과

## 실행 정보

| 항목 | 값 |
|------|-----|
| **실행 일시** | 2026-01-18 18:07:04 |
| **kube-burner 버전** | v2.2.0 |
| **클러스터** | Docker Desktop Kubernetes |
| **Kubernetes 버전** | v1.32.2 |
| **실행 UUID** | 38aa0c0b-dfad-4592-b10e-afd51d5f1f43 |

## 실행된 테스트

> **⚠️ 주의:** 이 테스트는 **제가 직접 만든 커스텀 테스트**입니다.  
> kube-burner의 **공식 시나리오**(cluster-density, node-density 등)가 아닙니다.  
> 목적: kube-burner의 기본 동작 방식을 이해하기 위한 간단한 POC입니다.

### 간단한 Pod 생성 테스트 (커스텀 테스트)

**설정 파일:** `simple-test-v2.yml` (직접 작성)

| 항목 | 값 |
|------|-----|
| **워크로드 이름** | simple-pod-test (커스텀 이름) |
| **네임스페이스** | kube-burner-test (자동으로 kube-burner-test-0 ~ kube-burner-test-9로 생성) |
| **반복 횟수** | 10 (jobIterations) |
| **리소스** | Pod (pause 이미지) |

**참고:**
- kube-burner의 **공식 시나리오**는 별도로 제공됩니다 (cluster-density, node-density 등)
- 이 테스트는 공식 시나리오가 아닌, **기본 동작 확인용 커스텀 테스트**입니다

## 실행 과정

### 1. Pre-load 단계

```
Pre-load: images from job simple-pod-test
Pre-load: Creating DaemonSet using images [registry.k8s.io/pause:3.9]
Pre-load: Sleeping for 1m0s
```

**의미:**
- 사용할 이미지를 미리 Pull하기 위한 Pre-load 단계
- DaemonSet을 생성하여 모든 노드에서 이미지 준비
- 1분 대기 후 정리

### 2. Job 실행 단계

```
Triggering job: simple-pod-test
Cleaning up previous runs
1/10 iterations completed
2/10 iterations completed
...
10/10 iterations completed
Waiting up to 4h0m0s for actions to be completed
```

**의미:**
- 이전 실행 리소스 정리
- 10번 반복 실행 (각 iteration마다 Pod 생성)
- 각 iteration마다 네임스페이스 생성: `kube-burner-test-0`, `kube-burner-test-1`, ... `kube-burner-test-9`
- 작업 완료 대기 (최대 4시간 타임아웃)

### 3. 완료 확인 단계

```
Actions in namespace kube-burner-test-0 completed
Actions in namespace kube-burner-test-1 completed
...
Actions in namespace kube-burner-test-9 completed
Verifying created objects
Job simple-pod-test took 3s
Finished execution with UUID: 38aa0c0b-dfad-4592-b10e-afd51d5f1f43
```

**의미:**
- 모든 네임스페이스에서 작업 완료
- 생성된 오브젝트 검증
- 전체 실행 시간: **3초**
- 실행 완료

## 실행 결과

### 실행 시간

- **전체 실행 시간**: 3초
- **Pre-load 시간**: 1분 (이미지 준비)
- **Job 실행 시간**: 3초

### 생성된 리소스

**네임스페이스:**
- `kube-burner-test-0` ~ `kube-burner-test-9` (10개 네임스페이스)
- 각 네임스페이스에 Pod 1개씩 생성 (총 10개 Pod)

**Pod:**
- 각 iteration마다 Pod 생성
- Pod 이름: `test-pod` (각 네임스페이스마다)
- 이미지: `registry.k8s.io/pause:3.9`

### 리소스 정리

**자동 정리:**
- 실행 완료 후 자동으로 리소스 정리
- 네임스페이스와 Pod가 삭제됨

## 결과 분석

### 어떤 성능을 테스트했는가?

**현재 실행:**
- **기본 리소스 생성 테스트**: Pod 생성 동작 확인
- **반복 실행 테스트**: 10번 반복 실행
- **자동 정리 테스트**: 리소스 정리 동작 확인

**미수집 메트릭:**
- Pod latency (Prometheus 필요)
- API latency (Prometheus 필요)
- Resource usage (Prometheus 필요)

**의미:**
- Prometheus 없이도 기본 리소스 생성/삭제 동작 확인 가능
- 성능 메트릭은 Prometheus 필요

### 어떤 방식으로 테스트했는가?

**테스트 방식:**

1. **Pre-load 단계**
   - 이미지 Pull을 위한 DaemonSet 생성
   - 모든 노드에서 이미지 준비

2. **Job 실행 단계**
   - 설정 파일의 `jobIterations`만큼 반복
   - 각 iteration마다:
     - 네임스페이스 생성
     - Pod 생성
     - 완료 대기

3. **완료 확인 단계**
   - 생성된 오브젝트 검증
   - 리소스 정리

**특징:**
- **반복 실행**: `jobIterations` 설정만큼 반복
- **네임스페이스별 실행**: 각 iteration마다 별도 네임스페이스 사용
- **자동 정리**: 실행 완료 후 자동 정리

### 결과를 어떻게 리포팅하는가?

**콘솔 출력:**
- 실행 로그를 콘솔에 출력
- iteration 진행 상황, 완료 시간 등

**리포트 파일 (Prometheus 있을 때):**
- `reports/metrics.json`: 수집된 메트릭 데이터
- `reports/thresholds.json`: Threshold 검증 결과
- `reports/index.json`: 인덱스 정보

**현재 상태:**
- Prometheus 없어서 리포트 파일 미생성
- 콘솔 로그로만 결과 확인

### 무엇을 기준으로 통과/실패를 판단하는가?

**현재 실행:**
- 리소스 생성 성공 여부
- 실행 완료 여부 (에러 없이 완료)

**Threshold 검증 (Prometheus 있을 때):**

```yaml
thresholds:
- metricName: podLatency
  operator: ">="
  value: 5000  # 5초 초과 시 실패
```

**Pass/Fail 판단:**
- Threshold 위반 시 Fail
- 모든 iteration 완료 시 Pass (에러 없이)

## 주요 학습 내용

### 1. kube-burner 실행 구조

**실행 단계:**
1. Pre-load (이미지 준비)
2. Job 실행 (리소스 생성)
3. 완료 확인 및 정리

### 2. 네임스페이스 자동 생성

**확인된 동작:**
- `namespace: kube-burner-test` 설정 시
- 실제로는 `kube-burner-test-0`, `kube-burner-test-1`, ... 형태로 생성
- 각 iteration마다 별도 네임스페이스 사용

### 3. 자동 정리

**확인된 동작:**
- 실행 완료 후 자동으로 리소스 정리
- 네임스페이스와 Pod가 자동 삭제

### 4. Prometheus 의존성

**확인된 내용:**
- 기본 리소스 생성/삭제는 Prometheus 없이도 가능
- 성능 메트릭 수집은 Prometheus 필요
- 리포트 파일 생성은 Prometheus 필요

## 다음 단계

1. **Prometheus 설치 후 메트릭 수집 테스트**
   - Pod latency, API latency 등 측정
   - Threshold 검증

2. **결과 리포트 확인**
   - `reports/metrics.json` 분석
   - `reports/thresholds.json` 확인

3. **더 복잡한 워크로드 테스트**
   - cluster-density 시나리오
   - node-density 시나리오
